# MentorTrack 更新ワークフロー 🔄

## 📋 概要
開発PC（あなたのPC）で変更を加えた後、会社PC（本番環境）に安全に更新を適用する手順です。

## 🎯 更新の流れ（全体像）

```
開発PC                    会社PC
   ↓                        ↓
1. 変更を加える          5. バックアップ作成
   ↓                        ↓
2. テスト実行            6. アプリ停止
   ↓                        ↓
3. 更新パッケージ作成     7. 更新適用
   ↓                        ↓
4. 会社PCに転送          8. アプリ再起動
                            ↓
                         9. 動作確認
```

## 🚀 具体的な手順

### 【開発PC側】変更後の作業

#### ステップ1: 変更内容のテスト
```bash
# 現在のPCでアプリが正常に動作することを確認
python app.py
# ブラウザで http://127.0.0.1:5000 にアクセスしてテスト
```

#### ステップ2: バックアップ作成（念のため）
```bash
python backup_restore.py
# → 1. 完全バックアップ作成 を選択
```

#### ステップ3: 更新パッケージ作成
```bash
python create_update_package.py
```
- 更新内容に応じて適切なファイルを選択
- 更新の説明を入力
- ZIPファイルが作成される

#### ステップ4: 会社PCに転送
- 作成されたZIPファイルを会社PCにコピー
- USBメモリ、クラウドストレージ、メールなど

---

### 【会社PC側】更新作業

#### ステップ5: 事前バックアップ
```bash
python backup_restore.py
# → 1. 完全バックアップ作成 を選択
```

#### ステップ6: アプリ停止
- `start_mentortrack.bat` のウィンドウを閉じる
- ブラウザのタブも閉じる

#### ステップ7: 更新適用
1. 更新ZIPファイルを展開
2. `update.bat` をダブルクリック
3. 画面の指示に従う

#### ステップ8: アプリ再起動
```bash
start_mentortrack.bat
```

#### ステップ9: 動作確認
- ブラウザで `http://127.0.0.1:5000` にアクセス
- 既存データが正常に表示されるか確認
- 新機能が動作するか確認

## 📊 更新の種類別ガイド

### 🎨 UI/機能改善の場合
- **更新対象**: `app.py`, `templates/`
- **データ影響**: なし
- **所要時間**: 5-10分
- **リスク**: 低

### 📦 新機能追加の場合
- **更新対象**: `app.py`, `templates/`, `requirements.txt`
- **データ影響**: 可能性あり
- **所要時間**: 10-20分
- **リスク**: 中

### 🗄️ データベース変更の場合
- **更新対象**: `app.py`, データベーススキーマ
- **データ影響**: あり（移行が必要）
- **所要時間**: 20-30分
- **リスク**: 高

## ⚠️ 重要な注意事項

### 必ずやること
1. **更新前にバックアップ** - 何かあっても復元できる
2. **アプリの完全停止** - ファイルロックエラーを防ぐ
3. **段階的な確認** - 各ステップで動作確認

### やってはいけないこと
1. **バックアップなしで更新** - データ消失のリスク
2. **アプリ実行中に更新** - ファイル破損のリスク
3. **一度に大量の変更** - 問題の特定が困難

## 🆘 トラブル時の対処法

### 更新に失敗した場合
1. **アプリを停止**
2. **バックアップから復元**
   ```bash
   python backup_restore.py
   # → 5. バックアップから復元 を選択
   ```
3. **開発者に連絡**（エラーメッセージを添付）

### よくある問題と解決法

#### 問題: "ファイルが使用中です"
```
原因: アプリが完全に停止していない
解決: タスクマネージャーでPythonプロセスを終了
```

#### 問題: "権限がありません"
```
原因: 管理者権限が必要
解決: 右クリック → 管理者として実行
```

#### 問題: "データが表示されない"
```
原因: データベースファイルの問題
解決: instance/ フォルダを復元
```

## 📈 将来的な改善案

### レベル2: 半自動更新（中級者向け）
- Git を使った変更管理
- 更新の自動検知

### レベル3: 完全自動更新（上級者向け）
- CI/CD パイプライン
- 自動テスト・デプロイ

## 📞 サポート

### 更新で困った時の連絡事項
1. **エラーメッセージ**のスクリーンショット
2. **どのステップで失敗したか**
3. **バックアップの有無**
4. **会社PCの環境情報**

---
📅 最終更新: """ + datetime.now().strftime("%Y年%m月%d日") + """
🏷️ バージョン: 更新管理システム v1.0
"""
